---
title: "01REAN ZÃ¡poÄtovÃ½ Ãºkol"
author: "Míra kubù"
date: " 17. prosince 2018"
output: 
  word_document:
    fig_height: 4
    fig_width: 6
  html_document:
    fig_height: 4
    fig_width: 6
  pdf_document:
    fig_height: 4
    fig_width: 6
---

<!-- KomentÃ¡Å™ v textovÃ© ÄÃ¡sti: nÃ¡slednÃ½ kod tam nebude -->

```{r include=FALSE}
# komentar v R: pokud include = F tak se kÃ³d v protokolu nezobrazÃ­
# Set the working directory
getwd()  # find where are you at the moment 
#setwd("d:/Vyuka/REAN/2018/Final_HW2018")

# pokud vam nefunguje markdown, nainstalujte si nejdrive balicek
#install.packages("rmarkdown")

# balicky nejspise potrebne pro praci behem zapoctove ulohy
load.libraries <- c('car','MASS','ggplot2','ISLR','graphics','effects','lattice','leaps','psych','lmtest','robustbase')
install.lib <- load.libraries[!load.libraries %in% installed.packages()]
for(libs in install.lib) install.packages(libs, dependences = TRUE)
sapply(load.libraries, require, character = TRUE)

```

<!-- Sekce se znaÄÃ­ pomocÃ­ # -->
# Å˜eÅ¡enÃ­ zÃ¡poÄtovÃ© Ãºlohy 

JednotlivÃ© otÃ¡zky jsem vypracoval samostatnÄ› a nikdo krom maminky mi nepomÃ¡hal. øzw fsdf qw fw

<!-- podsekce se znaÄÃ­ pomocÃ­ ## atd. -->

## PrÅ¯zkumovÃ¡ a grafickÃ¡ ÄÃ¡st:

*Q01: ZjistÄ›te, zdali data neobsahujÃ­ chybÄ›jÃ­cÃ­ hodnoty (\texttt{NA}), pokud ano tak rozhodnÄ›te zdali mÅ¯Å¾ete pÅ™Ã­sluÅ¡nÃ¡ pozorovÃ¡nÃ­ z dat odstranit. KterÃ© promÄ›nnÃ© jsou kvantitativnÃ­ a kterÃ© kvalitativnÃ­? Jeli moÅ¾no nÄ›kterÃ© zaÅ™adit do obou skupin, pro kterou se rozhodnete? KterÃ© promÄ›nnÃ© budete brÃ¡t jako faktorovÃ© a proÄ?
*  
```{r }
# read data file
auta = read.csv("Car_data.csv",  header = TRUE, sep=";")
# print summary
summary(auta)
str(auta) 
```
MÃ¡ odpovÄ›Ä na otÃ¡zku 1 je ...  

*Q02: PromÄ›nnou \texttt{Mileage} nahraÄte promÄ›nnou \texttt{Odometer} kde bude uveden stav tachometru v kilometrech mÃ­sto v mÃ­lÃ­ch. Vysv2tlovanou promÄ›nnou \texttt{Price} pÅ™eveÄte z USD na CZK. Vykreslete histogramy a odhady hustot pro tyto dvÄ› promÄ›nnÃ©, tj  \texttt{Price} a  \texttt{Odometer}.
*  

```{r include=FALSE}
# tady si nÄ›co mÅ¯Å¾u robit a v protokolu se to nezobrazÃ­
```

```{r}
# tohle uÅ¾ tam vidÄ›t bude ...
with(auta,plot(Price~Mileage))
```

MÃ¡ odpovÄ›Ä na otÃ¡zku 2 je ...



*Q03:   Pro promÄ›nnÃ© \texttt{Price, Odometer} vykreslete \texttt{scatterplot} - zÃ¡vislost odezvy na vysvÄ›tlujÃ­cÃ­ promÄ›nnÃ© a proloÅ¾te body jak lineÃ¡rnÃ­m odhadem tak vyhlazenou kÅ™ivkou lokÃ¡lnÃ­ regrese, buÄ pomocÃ­ LOESS (locally estimated scatterplot smoothing) nebo LOWESS (locally weighted scatterplot smoothing) (\texttt{lines(lowess(X,Y))}). Co lze z tohoto obrÃ¡zku tvrdit o zÃ¡vislosti ceny auta na poÄtu najetÃ½ch km?
*  

*Q04: Pro promÄ›nnÃ© \texttt{Make, Type, Doors, Cruise, Sound, Leather} a jejich vztah k odezvÄ›  \texttt{Price} vykreslete krabicovÃ© diagramy (boxploty). Je mezi uvedenÃ½mi promÄ›nnÃ½mi nÄ›kterÃ¡, pro kterou byste na zÃ¡kladÄ› krabicovÃ½ch diagramÅ¯ navrhli slouÄit urÄitÃ© ÃºrovnÄ› dohromady?
*  

*Q05: Pro kombinaci faktorizovanÃ½ch promÄ›nnÃ½ch \texttt{Make} a \texttt{Model} vykreslete cenu aut, aby bylo na obrÃ¡zku vidÄ›t, jestli se liÅ¡Ã­ ceny u jednotlivÃ½ch modelÅ¯ v zÃ¡vislosti na vÃ½robci a naopak jak se liÅ¡Ã­ ceny u jednotlivÃ½ch vÃ½robcÅ¯ v zÃ¡vislosti na modelu.
*  

*Q06: Pro auta vÃ½robce SAAB vykreslete zÃ¡vislost ceny na poÄtu ujetÃ½ch kilometrÅ¯, kde jednotlivÃ© udÃ¡losti oznaÄÃ­te barvou podle Typu auta a velikost bodÅ¯ v grafu bude odpovÃ­dat objemu motoru.
*  

*Q07: NavrhnÄ›te dalÅ¡Ã­ zobrazenÃ­ datovÃ©ho souboru.  ProveÄte ho a popiÅ¡te jeho ÃºÄel.
*

## RegresnÃ­ model zÃ¡vislosti ceny automobilu Saturn na poÄtu najetÃ½ch km.

*Q08: Sestavte jednoduchÃ½ regresnÃ­ model a na jeho zÃ¡kladech zjistÄ›te zdali cena ojetÃ©ho automobilu znaÄky Saturn zÃ¡visÃ­ na poÄtu najetÃ½ch kilometrÅ¯. Pokud ano, o kolik se zmÄ›nÃ­ odhadovanÃ¡ cena automobilu Saturn pÅ™i najetÃ­ 1000km navÃ­c? OvÄ›Å™te pÅ™edpoklady pro pouÅ¾itÃ­ lineÃ¡rnÃ­ho modelu a diskutujte vÃ½stup. 
*  

*Q09: DÃ¡ se pÅ™edeÅ¡lÃ½ jednoduchÃ½ regresnÃ­ model zlepÅ¡it pomocÃ­ logaritmickÃ© transformace odezvy? Jak se potÃ© 
	zmÄ›nÃ­ (navÃ½Å¡Ã­/poklesne) cena automobilÅ¯ pÅ™i zmÄ›nÄ› poÄtu najetÃ½ch kilometrÅ¯ o 1000 km? ZdÅ¯vodnÄ›te proÄ pÅ™Ã­padnÃ¡ transformace je pÅ™Ã­nosnÃ¡, nebo naopak nepÅ™Ã­nosnÃ¡.
*  

*Q10: VyzkouÅ¡ejte transformovat nezÃ¡vislou promÄ›nnou  \texttt{Odometer}. VyzkouÅ¡ejte napÅ™Ã­klad po ÄÃ¡stech konstantnÃ­ transformaci,  splines a polynomiÃ¡lnÃ­ transformaci (kvadratickou a kubickou). 
*  

*Q11: Vykreslete scatterplot skuteÄnÃ½ch cen aut a stavu tachometru a na zÃ¡kladÄ› vybranÃ©ho modelu, proloÅ¾te skrze data odhadnutou regresnÃ­ pÅ™Ã­mku a vykreslete 95\% konfidenÄnÃ­ intervaly jak pro predikovanÃ© hodnoty, tak pro regresnÃ­ pÅ™Ã­mku (tzv. Confidence a Prediction band). Porovnejte s vÃ½sledkem z funkce \texttt{plot(allEffects(model))}.
*  

*Q12: PÅ™idejte k vysvÄ›tlujÃ­cÃ­m promÄ›nnÃ½m i \texttt{Type} a \texttt{Model}, navrhnÄ›te aditivnÃ­ lineÃ¡rnÃ­ model, a ve scatterplotu vykreslete jednotlivÃ© skupiny rÅ¯znÃ½mi barvami a data proloÅ¾te odpovÃ­dajÃ­cÃ­mi regresnÃ­mi pÅ™Ã­mkami.
*  

*Q13: ProveÄte validaci modelu z bodu 11 pomocÃ­ pÅ™Ã­sluÅ¡nÃ½ch testÅ¯ na rezidua a pomocÃ­ pÅ™Ã­sluÅ¡nÃ½ch obrÃ¡zkÅ¯ (QQplot, residua vs. fitted, atd.)
*  

## VÃ­cerozmÄ›rnÃ½ regresnÃ­ model

*Q14: Porovnejte pomocÃ­ vhodnÃ©ho statistickÃ©ho testu shodnost stÅ™ednÃ­ch hodnot cen u automobilÅ¯ majÃ­cÃ­ a nemajÃ­cÃ­ tempomat, u atomobilÅ¯ majÃ­cÃ­ a nemajÃ­cÃ­ vylepÅ¡enÃ© reproduktory a majÃ­cÃ­ a nemajÃ­cÃ­ sedaÄky v kÅ¯Å¾i. ZdÅ¯vodnÄ›te, zdali tyto statistickÃ© testy jsou vypovÃ­dajÃ­cÃ­ a zdali lze z nich urÄit dÅ¯leÅ¾itost danÃ½ch promÄ›nnÃ½ch pro predikci ceny automobilu.
*  

*Q15: Zkonstruujte lineÃ¡rnÃ­ model popisujÃ­cÃ­ cenu automobilÅ¯ GM s vyuÅ¾itÃ­m vÅ¡ech dostupnÃ½ch promÄ›nnÃ½ch, kde bude pÅ™Ã­tomna interakce nejvÃ½Å¡e dvou promÄ›nnÃ½ch. Na zÃ¡kladÄ› kritÃ©riÃ­ jako jsou \texttt{AIC, BIC, $R^2$, F, atd. } vyberte nejvhodnÄ›jÅ¡Ã­ model. Ten validujte a okomentujte jeho vÃ½bÄ›r. 
*  

*Q16: Pro vybranÃ½ model z bodu 15, vyzkouÅ¡ejte jak logaritmickou transformaci odezvy \texttt{Price}, tak Box-Coxovu transformaci pro zlepÅ¡enÃ­ normality reziduÃ­.  Vykreslete optimÃ¡lnÃ­ log-vÄ›rohodnostnÃ­ profil u Box-Coxovy transformace a porovnejte navrÅ¾enou mocninou transformaci s logaritmickou. Pro kterÃ½ model se rozhodnete a proÄ?
*  

*Q17: Pro model s log transformovanou cenou v bodÄ› 15 vyÄtÄ›te procentuÃ¡lnÃ­ navÃ½Å¡enÃ­/pokles ceny automobilÅ¯
	pÅ™i zmÄ›nÄ› poÄtu najetÃ½ch kilometrÅ¯ o 1000 km.  Porovnejte jak se zmÄ›nil vliv poÄtu najetÃ½ch kilometrÅ¯ na cenu automobilÅ¯ Saturn v porovnÃ¡nÃ­ s modelem z bodu 9.
*  

*Q18: SpoÄtÄ›te korelace mezi vÅ¡emi dostupnÃ½mi promÄ›nnÃ½mi, kde to dÃ¡vÃ¡ smysl a u korelovanÃ½ch promÄ›nnÃ½ch se pokuste zdÅ¯vodnit dÅ¯vod tÃ©to korelace. Zkoumejte pÅ™Ã­padnou multikolinearitu ve vaÅ¡em finÃ¡lnÃ­m modelu z bodu 16 a pomocÃ­ podmÃ­nÄ›nosti matice regresorÅ¯, VIF a dalÅ¡Ã­ch nÃ¡strojÅ¯ validujte vÃ¡Å¡ vÃ½bÄ›r.
*  	

*Q19: Vykreslete tzv. \textit{Partial regression plot} a tzv. \textit{Partial residual plot} pro finÃ¡lnÃ­ model, okomentujte co nÃ¡m zmÃ­nÄ›nÃ© grafy Å™Ã­kajÃ­ o vÃ½slednÃ©m modelu. 
*  	
		
*Q20:	Prezentujte vÃ¡Å¡ vÃ½slednÃ½ model pro predikci \texttt{Price}, diskutujte vÃ½slednÃ© parametry $R^2$ a $\sigma$ tohoto modelu. Validujte model (jak graficky, tak pomocÃ­ pÅ™Ã­sluÅ¡nÃ½ch testÅ¯ hypotÃ©z).
*  


## RobustnÃ­ regrese

*Q21: Obsahuje VÃ¡Å¡ model z bodu 19 nÄ›jakÃ¡ vlivnÃ¡ pozorovÃ¡nÃ­? Pokuste se detekovat odlehlÃ© a pÃ¡kovÃ© body pomocÃ­ rÅ¯znÃ½ch diagnostickÃ½ch nÃ¡strojÅ¯  tzv. \textit{leave-one-out deletion regression}.
*  

*Q22: Pokud jste odhalili nÄ›jakÃ¡ vlivnÃ¡ pozorovÃ¡nÃ­, jak byste s nimi naloÅ¾ili a proÄ?
*  

*Q23: Porovnejte regresnÃ­ koeficenty, kterÃ© jste obdrÅ¾eli z vÃ½slednÃ©ho klasickÃ©ho lineÃ¡rnÃ­ modelu (s a bez odlehlÃ½ch pozorovÃ¡nÃ­ch) s robustnÃ­mi modely. VyzkouÅ¡ejte MM odhad (pro dva druhy funkce $\psi$) a LTS odhad (pÅ™i pouÅ¾itÃ­ 90\% a 50\% pozorovÃ¡nÃ­)
*

## Kam dÃ¡l?

*Q24: Diskutujte jak by Å¡lo pÅ™Ã­padnÄ› zlepÅ¡it predikci, jakÃ© transformace jednotlivÃ½ch promÄ›nnÃ½ch by mohli pomoci. PÅ™evedli byste nÄ›kterÃ© dalÅ¡Ã­ spojitÃ© promÄ›nnÃ© na diskrÃ©tnÃ­ (na faktory)? JakÃ© dalÅ¡Ã­ kroky byste pÅ™i analÃ½ze navrhli?  
*  

*Q25: PÅ™edstavte si, Å¾e jste Älenem mafie, kterÃ¡ provozuje sÃ­Å¥ autobazarÅ¯. Od bosse dostanete Ãºkol spoÄÃ­tat, zdali se vyplatÃ­ stÃ¡Äet u aut odometry. Bazary provozujete ve stÃ¡tÄ› s pochybnÃ½m prÃ¡vnÃ­m prostÅ™edÃ­m, kde stoÄenÃ­ tachometru nenÃ­ trestnÃ½ Äin a tudÃ­Å¾ hrozÃ­ jen pokuta. Pokud vaÅ¡e prodeje odpovÃ­dajÃ­ zkoumanÃ½m datÅ¯m, jak vysokÃ¡ by musela bÃ½t pokuta, aby se nevyplatilo stÃ¡Äet odometr? PÅ™edpoklÃ¡dejte, Å¾e VÃ¡s v prÅ¯mÄ›ru odhalÃ­ u kaÅ¾dÃ©ho 500 auta a v prÅ¯mÄ›ru budete stÃ¡Äet odometry o 10000 km.
*



